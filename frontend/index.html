<!DOCTYPE html>
<html>
  <head>
    <title>Eyevinn Technology OTT-Only TV Channel</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel='stylesheet' href='main.css' />
  </head>
  <body>
    <div id="errordlg" class="error-hidden"></div>
    <div id="videocontainer" class="video-stopped">
      <div id="clock" class="clock"></div>
      <div id="audiosymbol"></div>
      <div id="playbutton" class="playbtn playbtn-visible"></div>
      <video id="mainview"></video>
      <div id="overlay" class="overlay overlay-hidden">
        <div class="logo"></div>
        <div class="sitedesc">Demonstration of a Cloud-based OTT-Only TV channel</div>
        <div class="instructions">Click on window to mute / unmute</div>
      </div>
    </div>    
    <script src="https://cdn.jsdelivr.net/npm/hls.js@0.8.9" type="text/javascript"></script>
    <script src="main.js" type="text/javascript"></script>
    <script>
      var params = parseQueryParams(location.search);
      var uri;
      if (params['dev']) {
        uri = 'http://localhost:8000/live/master.m3u8';
      } else {
        uri = 'https://ott-channel-engine.herokuapp.com/live/master.m3u8';
      }
      document.addEventListener("DOMContentLoaded", function(event) {
        initiatePlayer(uri, "mainview")
        .then(function(videoElement) {
          videoElement.muted = true;
          var playPromise = videoElement.play();
          if (playPromise !== undefined) {
            playPromise.catch(function(error) {
              // Autplay was prevented
              return initiateControllers(videoElement, false);
            }).then(function() {
              return initiateControllers(videoElement, true);
            });
          }
        })
        .then(function() {
          return initiateClock();
        }).catch(function(err) {
          displayErrorDlg(err);
        });
      });
    </script>
  </body>
</html>
